document.addEventListener("DOMContentLoaded",function(){const a=document.getElementById("filtroForm");a&&(a.addEventListener("submit",function(){localStorage.setItem("centro_civico",document.getElementById("centro_civico").value),localStorage.setItem("edad",document.getElementById("edad").value),localStorage.setItem("idioma",document.getElementById("idioma").value),localStorage.setItem("horario",document.getElementById("horario").value),localStorage.setItem("textoBusqueda",document.getElementById("textoBusqueda").value)}),document.getElementById("centro_civico").value=localStorage.getItem("centro_civico")||"",document.getElementById("edad").value=localStorage.getItem("edad")||"",document.getElementById("idioma").value=localStorage.getItem("idioma")||"todos",document.getElementById("horario").value=localStorage.getItem("horario")||"",document.getElementById("textoBusqueda").value=localStorage.getItem("textoBusqueda")||"");const i=document.getElementById("contenedorDni");i&&(i.style.visibility="hidden"),document.querySelectorAll('[data-bs-toggle="modal"]').forEach(r=>{r.addEventListener("click",function(u){u.preventDefault();const e=JSON.parse(this.dataset.actividad);document.getElementById("modal-actividad-id").textContent=e.id,document.getElementById("modal-actividad-titulo").textContent=e.titulo,document.getElementById("modal-actividad-descripcion").textContent=e.descripcion,document.getElementById("modal-actividad-idioma").textContent=e.idioma,document.getElementById("modal-actividad-horario").textContent=`${e.hora_inicio} - ${e.hora_fin}`,document.getElementById("modal-actividad-plazas").textContent=`${e.plazas_disponibles}/${e.plazas_totales}`;const g=e.edad_minima===null?"∞":e.edad_minima,y=e.edad_maxima===null?"∞":e.edad_maxima;document.getElementById("modal-actividad-edades").textContent=`${g} - ${y}`;const s=document.getElementById("modal-actividad-imagen");s.src=e.imagen?`/storage/${e.imagen}`:"/storage/actividades/default.jpg",s.alt=`Imagen de ${e.titulo}`;const t=document.querySelector("#confirmarApuntarse");e.plazas_disponibles===0?(t.disabled=!0,t.textContent="Sin plazas"):(t.disabled=!1,t.textContent="Inscribirme"),t.addEventListener("click",()=>{var n=new bootstrap.Modal(document.getElementById("inscripcionFormModal"));n.show()});var o=document.getElementById("contenedorDni"),d=document.getElementById("casillaDni");document.querySelector("#confirmarConfirmacion").addEventListener("click",async()=>{if(o.style.visibility==="hidden")o.style.visibility="visible";else{const n=d.value,v=/^[0-9]{8}[A-Z]$/;n.length!==9||!v.test(n)?(alert("El DNI debe tener 8 números seguidos de una letra mayúscula."),d.focus()):(document.querySelector('#inscripcionFormModal form input[name="id_actividad"]').value=document.getElementById("modal-actividad-id").textContent,document.querySelector("#inscripcionFormModal form").submit(),d.value="",o.style.visibility="hidden")}})})});const l=document.getElementById("resetearFiltrosBtn");l&&l.addEventListener("click",function(){document.getElementById("centro_civico").value="",document.getElementById("edad").value="",document.getElementById("idioma").value="todos",document.getElementById("horario").value="",document.getElementById("textoBusqueda").value="",document.getElementById("filtroForm").submit()});const c=document.getElementById("success-message");c&&setTimeout(function(){c.style.display="none"},5e3);const m=document.getElementById("danger-message");m&&setTimeout(function(){m.style.display="none"},5e3)});
